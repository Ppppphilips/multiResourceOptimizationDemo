# multiResourceOptimizationDemo
下述场景策略的简单实现

数据输入通过json文件

业务场景描述：
不同的业务的机组分别部署在不同模型Instance中
分别部署在物理机之上
附加考虑因素 
1.高可用
2.弹性伸缩
待分配Instance模型所占用的各类资源可预测
物理机当前使用情况可获取：最近2个月的数据，时间间隔1分钟。

问题范围定义
参考的系统资源类型
1.CPU
2.RAM
3.HD
4.Network
需求
1．单台部署扩容/缩容策略
2．N台部署（弹性）策略
解决问题，扩容/缩容的过程中防止资源分配倾斜，尽可能达到多类系统资源的均衡分配


1.1	单台扩容策略
根据当前物理机资源使用情况
Step1. 获取有足够剩余资源可分配的物理机 S1，S2…Sn
Step2当前是否满足高可用条件（比如需要在多少台不同的物理机部署），如若不满足，过滤掉Step1中已经部署过相同服务的物理机，得到S1，S2…Sm
Step3 根据当前物理机资源使用情况获得每台服务器的4种资源使用百分比 C%,R%,HD%,N%，然后计算出每台服务器这4个百分比序列的标准差sd1,sd2…sdm。
计算出每台服务器部署新的instance后的标准差sdn1,sdn2…sdnm。
分别计算sd1 – sdn1,sd2-sdn2 …sdm – sdnm。
在将新旧标准差相差最大（单台物理机各类资源平衡改善最多）的服务器上新建instance。

1.2	单台缩容策略
根据当前物理机资源使用情况
Step1. 获取所有已经部署给业务instance的物理机 S1，S2…Sn
Step2. 当前是否刚好满足高可用条件，如若不满足，过滤掉Step1中只部署1个改instance的物理机，得到S1，S2…Sm
Step3 从S1,S2…Sm中instance数最少的物理机中缩容一个instance模组，从而尽可能腾出整台物理机来减少成本。

2 弹性部署的扩容以及缩容在现有物理机资源足够分配的情况下（无需新加物理机）可以沿用N次单台扩容的策略。如果弹性扩容/缩容只是为了达到短时间的效果，可以专门标记为此而新加的物理机，这些物理机中只部署短时间扩容的instance，时间段过后可以关闭整台物理机。
